"use strict";(self.webpackChunkwoo_docs_migration=self.webpackChunkwoo_docs_migration||[]).push([[6101],{4741:(e,i,r)=>{r.r(i),r.d(i,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>t,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"features/email/email-preview","title":"Email Preview Integration","description":"Overview","source":"@site/../features/email/email-preview.md","sourceDirName":"features/email","slug":"/features/email/email-preview","permalink":"/docs/features/email/email-preview","draft":false,"unlisted":false,"editUrl":"https://github.com/woocommerce/woocommerce/tree/docusaurus-docs-prep/docs/docs/../features/email/email-preview.md","tags":[],"version":"current","frontMatter":{"post_title":"Email preview integration","sidebar_label":"Email preview integration"},"sidebar":"docsSidebar","previous":{"title":"HTML best practices","permalink":"/docs/features/email/email-html-best-practices"},"next":{"title":"High Performance Order Storage","permalink":"/docs/features/high-performance-order-storage/"}}');var o=r(4848),s=r(8453);const t={post_title:"Email preview integration",sidebar_label:"Email preview integration"},l="Email Preview Integration",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Integration Hooks",id:"integration-hooks",level:2},{value:"Style and Content Settings",id:"style-and-content-settings",level:3},{value:"<code>woocommerce_email_preview_email_style_setting_ids</code>",id:"woocommerce_email_preview_email_style_setting_ids",level:4},{value:"<code>woocommerce_email_preview_email_content_setting_ids</code>",id:"woocommerce_email_preview_email_content_setting_ids",level:4},{value:"Dummy Data Modification",id:"dummy-data-modification",level:3},{value:"<code>woocommerce_email_preview_dummy_order</code>",id:"woocommerce_email_preview_dummy_order",level:4},{value:"<code>woocommerce_email_preview_dummy_product</code>",id:"woocommerce_email_preview_dummy_product",level:4},{value:"<code>woocommerce_email_preview_dummy_product_variation</code>",id:"woocommerce_email_preview_dummy_product_variation",level:4},{value:"<code>woocommerce_email_preview_dummy_address</code>",id:"woocommerce_email_preview_dummy_address",level:4},{value:"Placeholders and Email Object",id:"placeholders-and-email-object",level:3},{value:"<code>woocommerce_email_preview_placeholders</code>",id:"woocommerce_email_preview_placeholders",level:4},{value:"<code>woocommerce_prepare_email_for_preview</code>",id:"woocommerce_prepare_email_for_preview",level:4},{value:"Best Practices",id:"best-practices",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2}];function a(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.header,{children:(0,o.jsx)(i.h1,{id:"email-preview-integration",children:"Email Preview Integration"})}),"\n",(0,o.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(i.p,{children:"WooCommerce's Email Preview feature allows you to preview email templates using dummy data (i.e., it doesn't use the actual data from the database). This means that extensions registering new email types need to integrate with the email preview system to properly showcase their emails."}),"\n",(0,o.jsx)(i.h2,{id:"integration-hooks",children:"Integration Hooks"}),"\n",(0,o.jsx)(i.p,{children:"The following hooks allow extensions to take full control of email preview:"}),"\n",(0,o.jsx)(i.h3,{id:"style-and-content-settings",children:"Style and Content Settings"}),"\n",(0,o.jsx)(i.p,{children:"These hooks allow extensions to add new style and content settings that the email preview listens for changes, and updates the preview when changes are made."}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_email_preview_email_style_setting_ids",children:(0,o.jsx)(i.code,{children:"woocommerce_email_preview_email_style_setting_ids"})}),"\n",(0,o.jsx)(i.p,{children:"Add new email style settings that the email preview listens for changes."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_email_preview_email_style_setting_ids', function( $setting_ids ) {\n    $setting_ids[] = 'my_extension_email_style';\n    return $setting_ids;\n} );\n"})}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_email_preview_email_content_setting_ids",children:(0,o.jsx)(i.code,{children:"woocommerce_email_preview_email_content_setting_ids"})}),"\n",(0,o.jsx)(i.p,{children:"Add new email content settings that the email preview listens for changes."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_email_preview_email_content_setting_ids', function( $setting_ids ) {\n    $setting_ids[] = 'my_extension_email_content';\n    return $setting_ids;\n} );\n"})}),"\n",(0,o.jsx)(i.h3,{id:"dummy-data-modification",children:"Dummy Data Modification"}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_email_preview_dummy_order",children:(0,o.jsx)(i.code,{children:"woocommerce_email_preview_dummy_order"})}),"\n",(0,o.jsxs)(i.p,{children:["Modify the dummy ",(0,o.jsx)(i.code,{children:"WC_Order"})," object used in preview."]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_email_preview_dummy_order', function( $order ) {\n    // Modify the dummy order object\n    $order->set_currency( 'EUR' );\n    return $order;\n} );\n"})}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_email_preview_dummy_product",children:(0,o.jsx)(i.code,{children:"woocommerce_email_preview_dummy_product"})}),"\n",(0,o.jsx)(i.p,{children:"Modify the dummy product used in preview."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_email_preview_dummy_product', function( $product ) {\n    // Modify the dummy product object\n    $product->set_name( 'My Product' );\n    return $product;\n} );\n"})}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_email_preview_dummy_product_variation",children:(0,o.jsx)(i.code,{children:"woocommerce_email_preview_dummy_product_variation"})}),"\n",(0,o.jsx)(i.p,{children:"Modify the dummy product variation used in preview."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_email_preview_dummy_product_variation', function( $variation ) {\n    // Modify the dummy variation object\n    $variation->set_name( 'My Variation' );\n    return $variation;\n} );\n"})}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_email_preview_dummy_address",children:(0,o.jsx)(i.code,{children:"woocommerce_email_preview_dummy_address"})}),"\n",(0,o.jsx)(i.p,{children:"Modify the dummy address used in preview."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_email_preview_dummy_address', function( $address ) {\n    // Modify the dummy address array\n    $address['first_name'] = 'Preview';\n    $address['last_name'] = 'Customer';\n    return $address;\n} );\n"})}),"\n",(0,o.jsx)(i.h3,{id:"placeholders-and-email-object",children:"Placeholders and Email Object"}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_email_preview_placeholders",children:(0,o.jsx)(i.code,{children:"woocommerce_email_preview_placeholders"})}),"\n",(0,o.jsx)(i.p,{children:"Modify placeholders to be replaced in the email."}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_email_preview_placeholders', function( $placeholders ) {\n    // Add custom placeholders\n    $placeholders['{custom_placeholder}'] = 'Custom Value';\n    return $placeholders;\n} );\n"})}),"\n",(0,o.jsx)(i.h4,{id:"woocommerce_prepare_email_for_preview",children:(0,o.jsx)(i.code,{children:"woocommerce_prepare_email_for_preview"})}),"\n",(0,o.jsxs)(i.p,{children:["Modify the ",(0,o.jsx)(i.code,{children:"WC_Email"})," object used in preview."]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-php",children:"add_filter( 'woocommerce_prepare_email_for_preview', function( $email ) {\n    // Modify the email object, e.g. to replace WC_Order\n    $email->set_object( $custom_object );\n    return $email;\n} );\n"})}),"\n",(0,o.jsx)(i.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsx)(i.p,{children:"When integrating with email preview:"}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"Use Appropriate Object Types"})}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["Use the correct object type for your extension (e.g., ",(0,o.jsx)(i.code,{children:"WC_Subscription"})," instead of ",(0,o.jsx)(i.code,{children:"WC_Order"})," for WooCommerce Subscriptions)"]}),"\n",(0,o.jsx)(i.li,{children:"Ensure all required properties are set on dummy objects"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"Handle Placeholders"})}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Add all custom placeholders your extension uses"}),"\n",(0,o.jsx)(i.li,{children:"Provide realistic preview values for placeholders"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"Style and Content Settings"})}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Register all custom settings that affect email appearance or content"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"Testing"})}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Test preview with different email types"}),"\n",(0,o.jsx)(i.li,{children:"Verify all custom content appears correctly"}),"\n",(0,o.jsx)(i.li,{children:"Check responsive design"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,o.jsx)(i.p,{children:"Common issues and solutions:"}),"\n",(0,o.jsxs)(i.ol,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:'I see "There was an error rendering an email preview." error'})}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"There is a PHP error in your code that is causing the email preview to fail. Check your error log for more details."}),"\n",(0,o.jsxs)(i.li,{children:["Alternatively, you can modify ",(0,o.jsx)(i.a,{href:"https://github.com/woocommerce/woocommerce/blob/trunk/plugins/woocommerce/includes/admin/class-wc-admin.php",children:(0,o.jsx)(i.code,{children:"class-wc-admin.php"})})," and remove ",(0,o.jsxs)(i.a,{href:"https://github.com/woocommerce/woocommerce/blob/f5310a33fbb160a73ea2de95efe4759c3aa791ea/plugins/woocommerce/includes/admin/class-wc-admin.php#L212-L218",children:[(0,o.jsx)(i.code,{children:"try/catch"})," block"]})," around rendering the email preview to see the error message."]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"Style or Content Settings Changes Not Reflecting"})}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["Ensure the style settings are registered using the ",(0,o.jsx)(i.code,{children:"woocommerce_email_preview_email_style_setting_ids"})," filter"]}),"\n",(0,o.jsxs)(i.li,{children:["Ensure the content settings are registered using the ",(0,o.jsx)(i.code,{children:"woocommerce_email_preview_email_content_setting_ids"})," filter"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.strong,{children:"I don't see my extension's emails"})}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["Ensure the email is registered using the ",(0,o.jsx)(i.code,{children:"woocommerce_email_classes"})," filter"]}),"\n"]}),"\n"]}),"\n"]})]})}function m(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}},8453:(e,i,r)=>{r.d(i,{R:()=>t,x:()=>l});var n=r(6540);const o={},s=n.createContext(o);function t(e){const i=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function l(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),n.createElement(s.Provider,{value:i},e.children)}}}]);