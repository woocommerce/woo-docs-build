"use strict";(self.webpackChunkwoo_docs_migration=self.webpackChunkwoo_docs_migration||[]).push([[7319],{4642:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"extensions/extension-onboarding/handling-merchant-onboarding","title":"How to implement merchant onboarding","description":"Introduction","source":"@site/../extensions/extension-onboarding/handling-merchant-onboarding.md","sourceDirName":"extensions/extension-onboarding","slug":"/extensions/extension-onboarding/handling-merchant-onboarding","permalink":"/docs/extensions/extension-onboarding/handling-merchant-onboarding","draft":false,"unlisted":false,"editUrl":"https://github.com/woocommerce/woocommerce/tree/docusaurus-docs-prep/docs/docs/../extensions/extension-onboarding/handling-merchant-onboarding.md","tags":[],"version":"current","frontMatter":{"post_title":"How to implement merchant onboarding","sidebar_label":"Implement merchant onboarding"},"sidebar":"extensionsSidebar","previous":{"title":"How to create custom product tours","permalink":"/docs/extensions/extension-onboarding/creating-custom-product-tours"},"next":{"title":"Integrating with coming soon mode","permalink":"/docs/extensions/extension-onboarding/integrating-coming-soon-mode"}}');var o=n(4848),i=n(8453);const a={post_title:"How to implement merchant onboarding",sidebar_label:"Implement merchant onboarding"},r="How to implement merchant onboarding",c={},d=[{value:"Introduction",id:"introduction",level:2},{value:"Using setup tasks",id:"using-setup-tasks",level:2},{value:"Registering the task with PHP",id:"registering-the-task-with-php",level:3},{value:"Adding the task using JavaScript",id:"adding-the-task-using-javascript",level:3},{value:"Handle imports",id:"handle-imports",level:4},{value:"Construct the component",id:"construct-the-component",level:4},{value:"Register the Plugin for Task Content",id:"register-the-plugin-for-task-content",level:4},{value:"Register the Plugin for Task List Item Customization",id:"register-the-plugin-for-task-list-item-customization",level:4},{value:"Registering the task with JavaScript",id:"registering-the-task-with-javascript",level:3},{value:"Using Store Management Links",id:"using-store-management-links",level:2},{value:"Installing the Icons package",id:"installing-the-icons-package",level:3},{value:"Enqueuing the JavaScript",id:"enqueuing-the-javascript",level:3},{value:"Supply your link via JavaScript",id:"supply-your-link-via-javascript",level:3},{value:"Using Admin Notes",id:"using-admin-notes",level:2},{value:"Breaking it down",id:"breaking-it-down",level:3},{value:"Namespacing and feature availability checks",id:"namespacing-and-feature-availability-checks",level:4},{value:"Using Note and NoteTraits objects",id:"using-note-and-notetraits-objects",level:4},{value:"Provide a unique note name",id:"provide-a-unique-note-name",level:4},{value:"Configure the note&#39;s details",id:"configure-the-notes-details",level:4},{value:"Adding and deleting notes",id:"adding-and-deleting-notes",level:4}];function l(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"how-to-implement-merchant-onboarding",children:"How to implement merchant onboarding"})}),"\n",(0,o.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsx)(t.p,{children:"Onboarding is a critical part of the merchant's user experience. It helps set them up for success and ensures they're not only using your extension correctly but also getting the most out of it. There are a few especially useful features that you can take advantage of as a developer to help onboard merchants who are using your extension:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Setup tasks"}),"\n",(0,o.jsx)(t.li,{children:"Store management links"}),"\n",(0,o.jsx)(t.li,{children:"Admin notes"}),"\n"]}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"using-setup-tasks",children:"Using setup tasks"}),"\n",(0,o.jsx)(t.p,{children:"Setup tasks appear on the WooCommerce Admin home screen and prompt a merchant to complete certain steps in order to set up your extension. Adding tasks is a two-step process that requires:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Registering the task (and its JavaScript) using PHP"}),"\n",(0,o.jsx)(t.li,{children:"Using JavaScript to build the task, set its configuration, and add it to the task list"}),"\n"]}),"\n",(0,o.jsx)(t.h3,{id:"registering-the-task-with-php",children:"Registering the task with PHP"}),"\n",(0,o.jsx)(t.p,{children:"To register your task as an extended task list item, you'll need to start by creating a new PHP class that extends the Task class. This class will define the properties and behavior of your custom task."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"<?php\n/**\n * Custom task example.\n *\n */\nuse Automattic\\WooCommerce\\Admin\\Features\\OnboardingTasks\\Task;\n\n/**\n * Custom task class.\n */\nclass MyTask extends Task {\n\t/**\n\t * Get the task ID.\n\t *\n\t * @return string\n\t */\n\tpublic function get_id() {\n\t\treturn 'my-task';\n\t}\n\n\t/**\n\t * Title.\n\t *\n\t * @return string\n\t */\n\tpublic function get_title() {\n\t\treturn __( 'My task', 'woocommerce' );\n\t}\n\n\t/**\n\t * Content.\n\t *\n\t * @return string\n\t */\n\tpublic function get_content() {\n\t\treturn __( 'Add your task description here for display in the task list.', 'woocommerce' );\n\t}\n\n\t/**\n\t * Time.\n\t *\n\t * @return string\n\t */\n\tpublic function get_time() {\n\t\treturn __( '2 minutes', 'woocommerce' );\n\t}\n}\n"})}),"\n",(0,o.jsxs)(t.p,{children:["After defining your custom task class, add it to the task list by calling the ",(0,o.jsx)(t.code,{children:"add_task"})," method on the ",(0,o.jsx)(t.code,{children:"TaskLists"})," class. Please note that you need to call the add_task method before or in the ",(0,o.jsx)(t.code,{children:"init"})," hook because onboarding tasks are registered in the ",(0,o.jsx)(t.code,{children:"init"})," hook."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"# Register the task.\nfunction register_custom_task() {\n    // Register the task.\n    use Automattic\\WooCommerce\\Admin\\Features\\OnboardingTasks\\TaskLists;\n\n    TaskLists::add_task(\n        'extended', // The task list ID (e.g., 'extended' for \"Things to do next\").\n        new MyCustomTask(\n            TaskLists::get_list( 'extended' ) // Retrieve the task list object.\n        )\n    );\n}\n\n// Hook the registration function to the 'init' action.\nadd_action('init', 'register_custom_task');\n"})}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.code,{children:"TaskList"})," class represents a task list. It contains properties and methods for managing task list. We currently have three predefined task lists"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"setup"}),": The default task list"]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"extended"}),': The "Things to do next" task list']}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.code,{children:"secret_tasklist"}),': The "Secret" task list that is used for having tasks that are accessed by other means.']}),"\n"]}),"\n",(0,o.jsx)(t.h3,{id:"adding-the-task-using-javascript",children:"Adding the task using JavaScript"}),"\n",(0,o.jsx)(t.p,{children:"In addition to registering the task in PHP, You need to build the task component with JavaScript, set its configuration, and add it to the task list. For example, the JavaScript file for a simple task might look something like this:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"import { createElement } from '@wordpress/element';\nimport {\n\tWooOnboardingTask,\n\tWooOnboardingTaskListItem,\n} from '@woocommerce/onboarding';\nimport { registerPlugin } from '@wordpress/plugins';\n\nconst Task = ( { onComplete, task, query } ) => {\n\t// Implement your task UI/feature here.\n\treturn <div></div>;\n};\n\nregisterPlugin( 'add-task-content', {\n\trender: () => (\n\t\t<WooOnboardingTask id=\"my-task\">\n\t\t\t{ ( { onComplete, query, task } ) => (\n\t\t\t\t<Task onComplete={ onComplete } task={ task } query={ query } />\n\t\t\t) }\n\t\t</WooOnboardingTask>\n\t),\n} );\n\nregisterPlugin( 'add-task-list-item', {\n\tscope: 'woocommerce-tasks',\n\trender: () => (\n\t\t<WooOnboardingTaskListItem id=\"my-task\">\n\t\t\t{ ( { defaultTaskItem: DefaultTaskItem } ) => (\n\t\t\t\t// Add a custom wrapper around the default task item.\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"woocommerce-custom-tasklist-item\"\n\t\t\t\t\tstyle={ {\n\t\t\t\t\t\tborder: '1px solid red',\n\t\t\t\t\t} }\n\t\t\t\t>\n\t\t\t\t\t<DefaultTaskItem />\n\t\t\t\t</div>\n\t\t\t) }\n\t\t</WooOnboardingTaskListItem>\n\t),\n} );\n"})}),"\n",(0,o.jsx)(t.p,{children:"In the example above, the extension does a few different things. Let's break it down:"}),"\n",(0,o.jsx)(t.h4,{id:"handle-imports",children:"Handle imports"}),"\n",(0,o.jsx)(t.p,{children:"First, import any functions, components, or other utilities from external dependencies."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"import { createElement } from '@wordpress/element';\nimport {\n\tWooOnboardingTask,\n\tWooOnboardingTaskListItem,\n} from '@woocommerce/onboarding';\nimport { registerPlugin } from '@wordpress/plugins';\n"})}),"\n",(0,o.jsx)(t.h4,{id:"construct-the-component",children:"Construct the component"}),"\n",(0,o.jsxs)(t.p,{children:["Next, we create a ",(0,o.jsx)(t.a,{href:"https://reactjs.org/docs/components-and-props.html",children:"functional component"})," that returns our task card. The intermixed JavaScript/HTML syntax we're using here is called JSX. If you're unfamiliar with it, you can ",(0,o.jsx)(t.a,{href:"https://reactjs.org/docs/introducing-jsx.html",children:"read more about it in the React docs"}),"."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"import { onboardingStore } from '@woocommerce/data';\nimport { useDispatch } from '@wordpress/data';\n\nconst Task = ( { onComplete, task } ) => {\n\tconst { actionTask } = useDispatch( onboardingStore );\n\tconst { isActioned } = task;\n\n\treturn (\n\t\t<Card className=\"woocommerce-task-card\">\n\t\t\t<CardBody>\n\t\t\t\t{ __(\n\t\t\t\t\t\"This task's completion status is dependent on being actioned. The action button below will action this task, while the complete button will optimistically complete the task in the task list and redirect back to the task list. Note that in this example, the task must be actioned for completion to persist.\",\n\t\t\t\t\t'plugin-domain'\n\t\t\t\t) }{ ' ' }\n\t\t\t\t<br />\n\t\t\t\t<br />\n\t\t\t\t{ __( 'Task actioned status: ', 'plugin-domain' ) }{ ' ' }\n\t\t\t\t{ isActioned ? 'actioned' : 'not actioned' }\n\t\t\t\t<br />\n\t\t\t\t<br />\n\t\t\t\t<div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tonClick={ () => {\n\t\t\t\t\t\t\tactionTask( 'my-task' );\n\t\t\t\t\t\t} }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ __( 'Action task', 'plugin-domain' ) }\n\t\t\t\t\t</button>\n\t\t\t\t\t<button onClick={ onComplete }>\n\t\t\t\t\t\t{ __( 'Complete', 'plugin-domain' ) }\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</CardBody>\n\t\t</Card>\n\t);\n};\n"})}),"\n",(0,o.jsxs)(t.p,{children:["In the example above, we're using the ",(0,o.jsx)(t.code,{children:"Card"})," and ",(0,o.jsx)(t.code,{children:"CardBody"})," components to construct our task's component. The ",(0,o.jsx)(t.code,{children:"div"})," inside the ",(0,o.jsx)(t.code,{children:"CardBody"})," uses a ",(0,o.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#Expressions",children:"JavaScript expression"})," (",(0,o.jsx)(t.code,{children:"{}"}),") to embed a ternary operator that uses the component's state to determine whether to display the task as complete or incomplete."]}),"\n",(0,o.jsx)(t.h4,{id:"register-the-plugin-for-task-content",children:"Register the Plugin for Task Content"}),"\n",(0,o.jsxs)(t.p,{children:['Next, we register the Task component as a plugin named "add-task-content" using ',(0,o.jsx)(t.a,{href:"https://developer.wordpress.org/block-editor/reference-guides/slotfills/",children:"SlotFills"}),'. This plugin nests the Task component within a WooOnboardingTask component and passes the necessary properties. We also specify the scope of the plugin as "woocommerce-tasks" to make it effective only within WooCommerce\'s task list.']}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"registerPlugin( 'add-task-content', {\n\trender: () => (\n\t\t\n\t\t\t{ ( {\n\t\t\t\tonComplete,\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t\t\tquery,\n\t\t\t\ttask,\n\t\t\t} ) =>  }\n\t\t\n\t),\n\tscope: 'woocommerce-tasks',\n} );\n"})}),"\n",(0,o.jsx)(t.h4,{id:"register-the-plugin-for-task-list-item-customization",children:"Register the Plugin for Task List Item Customization"}),"\n",(0,o.jsx)(t.p,{children:'Finally, we register another plugin named "my-task-list-item-plugin." This plugin is used to customize the appearance of task list items. It also targets WooCommerce\'s task list and wraps the DefaultTaskItem component within a custom wrapper with additional styling.'}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"registerPlugin( 'my-task-list-item-plugin', {\n  scope: 'woocommerce-tasks',\n  render: () => (\n    <WooOnboardingTaskListItem id=\"my-task\">\n      { ( { defaultTaskItem: DefaultTaskItem } ) => (\n        // Add a custom wrapper around the default task item.\n        <div\n          className=\"woocommerce-custom-tasklist-item\"\n          style={ {\n            border: '1px solid red',\n          } }\n        >\n          <DefaultTaskItem />\n        </div>\n      ) }\n    </WooOnboardingTaskListItem>\n  ),\n} );\n"})}),"\n",(0,o.jsx)(t.p,{children:"In summary, the JavaScript file for a simple task extends and customizes the functionality of WooCommerce's task list, allowing users to better manage tasks and personalize the appearance of task list items."}),"\n",(0,o.jsx)(t.h3,{id:"registering-the-task-with-javascript",children:"Registering the task with JavaScript"}),"\n",(0,o.jsxs)(t.p,{children:["In addition to registering the task in php, you'll also need to register and enqueue the transpiled JavaScript file containing your task component and its configuration. A common way to do this is to create a dedicated registration function that hooks into the ",(0,o.jsx)(t.code,{children:"admin_enqueue_scripts"})," action in WordPress. Below is an annotated example of how this registration might look:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"/**\n * Register the scripts to fill the task content on the frontend.\n */\nfunction add_task_register_script() {\n\tif (\n\t\t! class_exists( 'Automattic\\WooCommerce\\Internal\\Admin\\Loader' ) ||\n\t\t! \\Automattic\\WooCommerce\\Admin\\PageController::is_admin_or_embed_page()\n\t) {\n\t\treturn;\n\t}\n\n\t$asset_file = require __DIR__ . '/dist/index.asset.php';\n\twp_register_script(\n\t\t'add-task',\n\t\tplugins_url( '/dist/index.js', __FILE__ ), // task registration JS\n\t\t$asset_file['dependencies'],\n\t\t$asset_file['version'],\n\t\ttrue\n\t);\n\n\twp_enqueue_script( 'add-task' );\n}\n\nadd_action( 'admin_enqueue_scripts', 'add_task_register_script' );\n"})}),"\n",(0,o.jsx)(t.p,{children:"By following these steps, your custom task should appear in the WooCommerce onboarding tasklist."}),"\n",(0,o.jsxs)(t.p,{children:["For a complete example of adding a custom task as a WordPress plugin, you can check out the ",(0,o.jsx)(t.a,{href:"https://github.com/woocommerce/woocommerce/tree/trunk/plugins/woocommerce/client/admin/docs/examples/extensions/add-task",children:"add-task examples directory"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["To learn more about the tasklist, you can refer to the ",(0,o.jsx)(t.a,{href:"https://github.com/woocommerce/woocommerce/blob/trunk/plugins/woocommerce/client/admin/docs/features/onboarding-tasks.md",children:"tasklist documentation"}),"."]}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"using-store-management-links",children:"Using Store Management Links"}),"\n",(0,o.jsx)(t.p,{children:"When a merchant completes all of the items on the onboarding task list, WooCommerce replaces it with a section containing a list of handy store management links. Discoverability can be a challenge for extensions, so this section is a great way to bring more attention to key features of your extension and help merchants navigate to them."}),"\n",(0,o.jsx)(t.p,{children:"The store management section has a relatively narrow purpose, so this section does not currently support external links. Instead, it is meant for navigating quickly within WooCommerce."}),"\n",(0,o.jsx)(t.p,{children:"Adding your own store management links is a simple process that involves:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"Installing dependencies for icon support"}),"\n",(0,o.jsx)(t.li,{children:"Enqueuing an admin script in your PHP"}),"\n",(0,o.jsx)(t.li,{children:"Hooking in via a JavaScript filter to provide your link object"}),"\n"]}),"\n",(0,o.jsx)(t.h3,{id:"installing-the-icons-package",children:"Installing the Icons package"}),"\n",(0,o.jsxs)(t.p,{children:["Store management links use the ",(0,o.jsx)(t.code,{children:"@wordpress/icons"})," package. If your extension isn't already using it, you'll need to add it to your extension's list of dependencies."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"npm"})," ",(0,o.jsx)(t.code,{children:"install"})," ",(0,o.jsx)(t.code,{children:"@wordpress``/icons"})," ",(0,o.jsx)(t.code,{children:"--save"})]}),"\n",(0,o.jsx)(t.h3,{id:"enqueuing-the-javascript",children:"Enqueuing the JavaScript"}),"\n",(0,o.jsx)(t.p,{children:"The logic that adds your custom link to the store management section will live in a JavaScript file. We'll register and enqueue that file with WordPress in our PHP file:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"function custom_store_management_link() {\n    wp_enqueue_script(\n        'add-my-custom-link',\n        plugins_url( '/dist/add-my-custom-link.js', __FILE__ ),\n        array( 'wp-hooks' ),\n        10\n    );\n}\nadd_action( 'admin_enqueue_scripts', 'custom_store_management_link' );\n\n"})}),"\n",(0,o.jsx)(t.p,{children:"The first argument of this call is a handle, the name by which WordPress will refer to the script we're enqueuing. The second argument is the URL where the script is located."}),"\n",(0,o.jsxs)(t.p,{children:["The third argument is an array of script dependencies. By supplying the ",(0,o.jsx)(t.code,{children:"wp-hooks"})," handle in that array, we're ensuring that our script will have access to the ",(0,o.jsx)(t.code,{children:"addFilter"})," function we'll be using to add our link to WooCommerce's list."]}),"\n",(0,o.jsx)(t.p,{children:"The fourth argument is a priority, which determines the order in which JavaScripts are loaded in WordPress. We're setting a priority of 10 in our example. It's important that your script runs before the store management section is rendered. With that in mind, make sure your priority value is lower than 15 to ensure your link is rendered properly."}),"\n",(0,o.jsx)(t.h3,{id:"supply-your-link-via-javascript",children:"Supply your link via JavaScript"}),"\n",(0,o.jsxs)(t.p,{children:["Finally, in the JavaScript file you enqueued above, hook in to the ",(0,o.jsx)(t.code,{children:"woocommerce_admin_homescreen_quicklinks"})," filter and supply your task as a simple JavaScript object."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-js",children:"import { megaphone } from '@wordpress/icons';\nimport { addFilter } from '@wordpress/hooks';\n \naddFilter(\n    'woocommerce_admin_homescreen_quicklinks',\n    'my-extension',\n    ( quickLinks ) => {\n        return [\n            ...quickLinks,\n            {\n                title: 'My link',\n                href: 'link/to/something',\n                icon: megaphone,\n            },\n        ];\n    }\n);\n"})}),"\n",(0,o.jsx)(t.hr,{}),"\n",(0,o.jsx)(t.h2,{id:"using-admin-notes",children:"Using Admin Notes"}),"\n",(0,o.jsx)(t.p,{children:"Admin Notes are meant for displaying insightful information about your WooCommerce store, extensions, activity, and achievements. They're also useful for displaying information that can help with the day-to-day tasks of managing and optimizing a store. A good general rule is to use Admin Notes for information that is:"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:"Timely"}),"\n",(0,o.jsx)(t.li,{children:"Relevant"}),"\n",(0,o.jsx)(t.li,{children:"Useful"}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:"With that in mind, you might consider using Admin Notes to celebrate a particular milestone that a merchant has passed, or to provide additional guidance about using a specific feature or flow. Conversely, you shouldn't use Admin Notes to send repeated messages about the same topic or target all users with a note that is only relevant to a subset of merchants. It's okay to use Admin Notes for specific promotions, but you shouldn't abuse the system. Use your best judgement and remember the home screen is meant to highlight a store's most important actionable tasks."}),"\n",(0,o.jsx)(t.p,{children:"Despite being a part of the new React-powered admin experience in WooCommerce, Admin Notes are available to developers via a standard PHP interface."}),"\n",(0,o.jsxs)(t.p,{children:["The recommended approach for using Admin Notes is to encapsulate your note within its own class that uses the ",(0,o.jsx)(t.a,{href:"https://github.com/woocommerce/woocommerce-admin/blob/831c9ff13a862f22cf53d3ae676daeabbefe90ad/src/Notes/NoteTraits.php",children:"NoteTraits"})," trait included with WooCommerce Admin. Below is a simple example of what this might look like:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"<?php\n/**\n * Simple note provider\n *\n * Adds a note with a timestamp showing when the note was added.\n */\n \nnamespace My\\Wonderfully\\Namespaced\\Extension\\Area;\n \n// Exit if this code is accessed outside of WordPress.\ndefined ( 'ABSPATH' ) || exit;\n \n// Check for Admin Note support\nif ( ! class_exists( 'Automattic\\WooCommerce\\Admin\\Notes\\Notes' ) ||\n     ! class_exists( 'Automattic\\WooCommerce\\Admin\\Notes\\NoteTraits' )) {\n    return;\n}\n \n// Make sure the WooCommerce Data Store is available\nif ( ! class_exists( 'WC_Data_Store' ) ) {\n    return;\n}\n \n \n/**\n * Example note class.\n */\nclass ExampleNote {\n \n    // Use the Note class to create Admin Note objects\n    use Automatic\\WooCommerce\\Admin\\Notes\\Note;\n \n    // Use the NoteTraits trait, which handles common note operations.\n    use Automatic\\WooCommerce\\Admin\\Notes\\NoteTraits;\n \n    // Provide a note name.\n    const NOTE_NAME = 'my-prefix-example-note';\n \n    public static function get_note() {\n    // Our welcome note will include information about when the extension\n    // was activated.  This is just for demonstration. You might include\n    // other logic here depending on what data your note should contain.\n        $activated_time = current_time( 'timestamp', 0 );\n        $activated_time_formatted = date( 'F jS', $activated_time );\n \n        // Instantiate a new Note object\n        $note = new Automattic\\WooCommerce\\Admin\\Notes\\Note();\n \n        // Set our note's title.\n        $note->set_title( 'Getting Started' );\n \n        // Set our note's content.\n        $note->set_content(\n            sprintf(\n                'Extension activated on %s.', $activated_time_formatted\n            )\n        );\n \n        // In addition to content, notes also support structured content.\n        // You can use this property to re-localize notes on the fly, but\n        // that is just one use. You can store other data here too. This\n        // is backed by a longtext column in the database.\n        $note->set_content_data( (object) array(\n            'getting_started'       => true,\n            'activated'             => $activated_time,\n            'activated_formatted'   => $activated_time_formatted\n        ) );\n \n        // Set the type of the note. Note types are defined as enum-style\n        // constants in the Note class. Available note types are:\n        // error, warning, update, info, marketing.\n        $note->set_type( Note::E_WC_ADMIN_NOTE_INFORMATIONAL );\n \n        // Set the type of layout the note uses. Supported layout types are:\n        // 'plain', 'thumbnail'\n        $note->set_layout( 'plain' );\n \n        // Set the image for the note. This property renders as the src\n        // attribute for an img tag, so use a string here.\n        $note->set_image( '' );\n \n \n        // Set the note name and source.  You should store your extension's\n        //   name (slug) in the source property of the note.  You can use\n        //   the name property of the note to support multiple sub-types of\n        //   notes.  This also gives you a handy way of namespacing your notes.\n        $note->set_source( 'inbox-note-example');\n        $note->set_name( self::NOTE_NAME );\n \n        // Add action buttons to the note.  A note can support 0, 1, or 2 actions.\n        //   The first parameter is the action name, which can be used for event handling.\n        //   The second parameter renders as the label for the button.\n        //   The third parameter is an optional URL for actions that require navigation.\n        $note->add_action(\n            'settings', 'Open Settings', '?page=wc-settings&tab=general'\n        );\n        $note->add_action(\n            'learn_more', 'Learn More', 'https://example.com'\n        );\n \n        return $note;\n    }\n}\n \nfunction my_great_extension_activate() {\n    // This uses the functionality from the NoteTraits trait to conditionally add your note if it passes all of the appropriate checks.\n    ExampleNote::possibly_add_note();\n}\nregister_activation_hook( __FILE__, 'my_great_extension_activate' );\n \nfunction my_great_extension_deactivate() {\n    // This uses the functionality from the NoteTraits trait to conditionally remove your note if it passes all of the appropriate checks.\n    ExampleNote::possibly_delete_note();\n}\nregister_deactivation_hook( __FILE__, 'my_great_extension_deactivate' );\n"})}),"\n",(0,o.jsx)(t.h3,{id:"breaking-it-down",children:"Breaking it down"}),"\n",(0,o.jsx)(t.p,{children:"Let's break down the example above to examine what each section does."}),"\n",(0,o.jsx)(t.h4,{id:"namespacing-and-feature-availability-checks",children:"Namespacing and feature availability checks"}),"\n",(0,o.jsx)(t.p,{children:"First, we're doing some basic namespacing and feature availability checks, along with a safeguard to make sure this file only executes within the WordPress application space."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"namespace My\\Wonderfully\\Namespaced\\Extension\\Area;\n \ndefined ( 'ABSPATH' ) || exit;\n \nif ( ! class_exists( 'Automattic\\WooCommerce\\Admin\\Notes\\Notes') ||\n     ! class_exists( 'Automattic\\WooCommerce\\Admin\\Notes\\NoteTraits') ) {\n    return;\n}\n \nif ( ! class_exists( 'WC_Data_Store' ) ) {\n    return;\n}\n"})}),"\n",(0,o.jsx)(t.h4,{id:"using-note-and-notetraits-objects",children:"Using Note and NoteTraits objects"}),"\n",(0,o.jsxs)(t.p,{children:["Next, we define a simple class that will serve as a note provider for our note. To create and manage note objects, we'll import the ",(0,o.jsx)(t.code,{children:"Note"})," and ",(0,o.jsx)(t.code,{children:"NotesTraits"})," classes from WooCommerce Admin."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"class ExampleNote {\n \n    use Automatic\\WooCommerce\\Admin\\Notes\\Note;\n    use Automatic\\WooCommerce\\Admin\\Notes\\NoteTraits;\n \n}\n"})}),"\n",(0,o.jsx)(t.h4,{id:"provide-a-unique-note-name",children:"Provide a unique note name"}),"\n",(0,o.jsxs)(t.p,{children:["Before proceeding, create a constant called ",(0,o.jsx)(t.code,{children:"NOTE_NAME"})," and assign a unique note name to it. The ",(0,o.jsx)(t.code,{children:"NoteTraits"})," class uses this constant for queries and note operations."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"const NOTE_NAME = 'my-prefix-example-note';"})}),"\n",(0,o.jsx)(t.h4,{id:"configure-the-notes-details",children:"Configure the note's details"}),"\n",(0,o.jsxs)(t.p,{children:["Once you've set your note's name, you can define and configure your note. The ",(0,o.jsx)(t.code,{children:"NoteTraits"})," class will call ",(0,o.jsx)(t.code,{children:"self::get_note()"})," when performing operations, so you should encapsulate your note's instantiation and configuration in a static function called ",(0,o.jsx)(t.code,{children:"get_note()"})," that returns a ",(0,o.jsx)(t.code,{children:"Note"})," object."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"public static function get_note() {\n    // We'll fill this in with logic that instantiates a Note object\n    //   and sets its properties.\n}\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Inside our ",(0,o.jsx)(t.code,{children:"get_note()"})," function, we'll handle any logic for collecting data our Note may need to display. Our example note will include information about when the extension was activated, so this bit of code is just for demonstration. You might include other logic here depending on what data your note should contain."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"$activated_time = current_time( 'timestamp', 0);\n$activated_time_formatted = date( 'F jS', $activated_time );\n\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Next, we'll instantiate a new ",(0,o.jsx)(t.code,{children:"Note"})," object."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"$note = new Note();"})}),"\n",(0,o.jsx)(t.p,{children:"Once we have an instance of the Note class, we can work with its API to set its properties, starting with its title."}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"$note->set_title( 'Getting Started' );"})}),"\n",(0,o.jsx)(t.p,{children:"Then we'll use some of the timestamp data we collected above to set the note's content."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"$note->set_content(\n    sprintf(\n        'Extension activated on %s.', $activated_time_formatted\n    )\n);\n"})}),"\n",(0,o.jsxs)(t.p,{children:["In addition to regular content, notes also support structured content using the ",(0,o.jsx)(t.code,{children:"content_data"})," property. You can use this property to re-localize notes on the fly, but that is just one use case. You can store other data here too. This is backed by a ",(0,o.jsx)(t.code,{children:"longtext"})," column in the database."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"$note->set_content_data( (object) array(\n    'getting_started'     => true,\n    'activated'           => $activated_time,\n    'activated_formatted' => $activated_time_formatted\n) );\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Next, we'll set the note's ",(0,o.jsx)(t.code,{children:"type"})," property. Note types are defined as enum-style class constants in the ",(0,o.jsx)(t.code,{children:"Note"})," class. Available note types are ",(0,o.jsx)(t.em,{children:"error"}),", ",(0,o.jsx)(t.em,{children:"warning"}),", ",(0,o.jsx)(t.em,{children:"update"}),", ",(0,o.jsx)(t.em,{children:"info"}),", and ",(0,o.jsx)(t.em,{children:"marketing"}),". When selecting a note type, be aware that the ",(0,o.jsx)(t.em,{children:"error"})," and ",(0,o.jsx)(t.em,{children:"update"})," result in the note being shown as a Store Alert, not in the Inbox. It's best to avoid using these types of notes unless you absolutely need to."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"$note->set_type( Note::E_WC_ADMIN_NOTE_INFORMATIONAL );"})}),"\n",(0,o.jsxs)(t.p,{children:["Admin Notes also support a few different layouts. You can specify ",(0,o.jsx)(t.code,{children:"banner"}),", ",(0,o.jsx)(t.code,{children:"plain"}),", or ",(0,o.jsx)(t.code,{children:"thumbnail"})," as the layout. If you're interested in seeing the different layouts in action, take a look at ",(0,o.jsx)(t.a,{href:"https://gist.github.com/octaedro/864315edaf9c6a2a6de71d297be1ed88",children:"this simple plugin"})," that you can install to experiment with them."]}),"\n",(0,o.jsxs)(t.p,{children:["We'll choose ",(0,o.jsx)(t.code,{children:"plain"})," as our layout, but it's also the default, so we could leave this property alone and the effect would be the same."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"$note->set_layout( 'plain' );"})}),"\n",(0,o.jsxs)(t.p,{children:["If you have an image that you want to add to your Admin Note, you can specify it using the ",(0,o.jsx)(t.code,{children:"set_image"})," function. This property ultimately renders as the ",(0,o.jsx)(t.code,{children:"src"})," attribute on an ",(0,o.jsx)(t.code,{children:"img"})," tag, so use a string here."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"$note->set_image( '' );"})}),"\n",(0,o.jsxs)(t.p,{children:["Next, we'll set the values for our Admin Note's ",(0,o.jsx)(t.code,{children:"name"})," and ",(0,o.jsx)(t.code,{children:"source"})," properties. As a best practice, you should store your extension's name (i.e. its slug) in the ",(0,o.jsx)(t.code,{children:"source"})," property of the note. You can use the ",(0,o.jsx)(t.code,{children:"name"})," property to support multiple sub-types of notes. This gives you a handy way of namespacing your notes and managing them at both a high and low level."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"$note->set_source( 'inbox-note-example');\n$note->set_name( self::NOTE_NAME );\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Admin Notes can support 0, 1, or 2 actions (buttons). You can use these actions to capture events that trigger asynchronous processes or help the merchant navigate to a particular view to complete a step, or even simply to provide an external link for further information. The ",(0,o.jsx)(t.code,{children:"add_action()"})," function takes up to three arguments. The first is the action name, which can be used for event handling, the second renders as a label for the action's button, and the third is an optional URL for actions that require navigation."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"$note->add_action(\n    'settings', 'Open Settings', '?page=wc-settings&tab=general'\n);\n$note->add_action(\n    'learn_more', 'Learn More', 'https://example.com'\n);\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Finally, remember to have the ",(0,o.jsx)(t.code,{children:"get_note()"})," function return the configured Note object."]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.code,{children:"return $note;"})}),"\n",(0,o.jsx)(t.h4,{id:"adding-and-deleting-notes",children:"Adding and deleting notes"}),"\n",(0,o.jsxs)(t.p,{children:["To add and delete notes, you can use the helper functions that are part of the ",(0,o.jsx)(t.code,{children:"NoteTraits"})," class: ",(0,o.jsx)(t.code,{children:"possibly_add_note()"})," and its counterpart ",(0,o.jsx)(t.code,{children:"possibly_delete_note()"}),". These functions will handle some of the repetitive logic related to note management and will also run checks to help you avoid creating duplicate notes."]}),"\n",(0,o.jsx)(t.p,{children:"Our example extension ties these calls to activation and deactivation hooks for the sake of simplicity. While there are many events for which you may want to add Notes to a merchant's inbox, deleting notes upon deactivation and uninstallation is an important part of managing your extension's lifecycle."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-php",children:"function my_great_extension_activate() {\n    ExampleNote::possibly_add_note();\n}\nregister_activation_hook( __FILE__, 'my_great_extension_activate' );\n \nfunction my_great_extension_deactivate() {\n    ExampleNote::possibly_delete_note();\n}\nregister_deactivation_hook( __FILE__, 'my_great_extension_deactivate' );\n\n"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>r});var s=n(6540);const o={},i=s.createContext(o);function a(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);