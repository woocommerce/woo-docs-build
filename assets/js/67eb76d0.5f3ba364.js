"use strict";(self.webpackChunkwoo_docs_migration=self.webpackChunkwoo_docs_migration||[]).push([[8772],{5178:(e,o,n)=>{n.r(o),n.d(o,{assets:()=>a,contentTitle:()=>i,default:()=>l,frontMatter:()=>r,metadata:()=>c,toc:()=>h});const c=JSON.parse('{"id":"best-practices/performance/configuring-caching-plugins","title":"How to configure caching plugins for WooCommerce","description":"Excluding pages from the cache","source":"@site/../best-practices/performance/configuring-caching-plugins.md","sourceDirName":"best-practices/performance","slug":"/best-practices/performance/configuring-caching-plugins","permalink":"/docs/best-practices/performance/configuring-caching-plugins","draft":false,"unlisted":false,"editUrl":"https://github.com/woocommerce/woocommerce/tree/docusaurus-docs-prep/docs/docs/../best-practices/performance/configuring-caching-plugins.md","tags":[],"version":"current","frontMatter":{"post_title":"How to configure caching plugins for WooCommerce","sidebar_label":"Configure caching plugins"},"sidebar":"docsSidebar","previous":{"title":"Development handbook","permalink":"/docs/block-development/product-editor-development/product-editor"},"next":{"title":"Performance best practices","permalink":"/docs/best-practices/performance/performance-best-practices"}}');var t=n(4848),s=n(8453);const r={post_title:"How to configure caching plugins for WooCommerce",sidebar_label:"Configure caching plugins"},i="How to configure caching plugins for WooCommerce",a={},h=[{value:"Excluding pages from the cache",id:"excluding-pages-from-the-cache",level:2},{value:"Excluding WooCommerce session from the cache",id:"excluding-woocommerce-session-from-the-cache",level:2},{value:"Excluding WooCommerce cookies from the cache",id:"excluding-woocommerce-cookies-from-the-cache",level:2},{value:"W3 total cache minify settings",id:"w3-total-cache-minify-settings",level:3},{value:"WP-Rocket",id:"wp-rocket",level:3},{value:"WP Super Cache",id:"wp-super-cache",level:3},{value:"Varnish",id:"varnish",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Why is my Varnish configuration not working in WooCommerce?",id:"why-is-my-varnish-configuration-not-working-in-woocommerce",level:3},{value:"Why is my Password Reset stuck in a loop?",id:"why-is-my-password-reset-stuck-in-a-loop",level:3}];function d(e){const o={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.header,{children:(0,t.jsx)(o.h1,{id:"how-to-configure-caching-plugins-for-woocommerce",children:"How to configure caching plugins for WooCommerce"})}),"\n",(0,t.jsx)(o.h2,{id:"excluding-pages-from-the-cache",children:"Excluding pages from the cache"}),"\n",(0,t.jsx)(o.p,{children:"Oftentimes if using caching plugins they'll already exclude these pages. Otherwise make sure you exclude the following pages from the cache through your caching systems respective settings."}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsx)(o.li,{children:"Cart"}),"\n",(0,t.jsx)(o.li,{children:"My Account"}),"\n",(0,t.jsx)(o.li,{children:"Checkout"}),"\n"]}),"\n",(0,t.jsx)(o.p,{children:"These pages need to stay dynamic since they display information specific to the current customer and their cart."}),"\n",(0,t.jsx)(o.h2,{id:"excluding-woocommerce-session-from-the-cache",children:"Excluding WooCommerce session from the cache"}),"\n",(0,t.jsxs)(o.p,{children:["If the caching system you're using offers database caching, it might be helpful to exclude ",(0,t.jsx)(o.code,{children:"_wc_session_"})," from being cached. This will be dependent on the plugin or host caching so refer to the specific instructions or docs for that system."]}),"\n",(0,t.jsx)(o.h2,{id:"excluding-woocommerce-cookies-from-the-cache",children:"Excluding WooCommerce cookies from the cache"}),"\n",(0,t.jsx)(o.p,{children:"Cookies in WooCommerce help track the products in your customers cart, can keep their cart in the database if they leave the site, and powers the recently viewed widget. Below is a list of the cookies WooCommerce uses for this, which you can exclude from caching."}),"\n",(0,t.jsxs)(o.table,{children:[(0,t.jsx)(o.thead,{children:(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.th,{children:"COOKIE NAME"}),(0,t.jsx)(o.th,{children:"DURATION"}),(0,t.jsx)(o.th,{children:"PURPOSE"})]})}),(0,t.jsxs)(o.tbody,{children:[(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:"woocommerce_cart_hash"}),(0,t.jsx)(o.td,{children:"session"}),(0,t.jsx)(o.td,{children:"Helps WooCommerce determine when cart contents/data changes."})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:"woocommerce_items_in_cart"}),(0,t.jsx)(o.td,{children:"session"}),(0,t.jsx)(o.td,{children:"Helps WooCommerce determine when cart contents/data changes."})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:"wp_woocommerce_session_"}),(0,t.jsx)(o.td,{children:"2 days"}),(0,t.jsx)(o.td,{children:"Contains a unique code for each customer so that it knows where to find the cart data in the database for each customer."})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:"woocommerce_recently_viewed"}),(0,t.jsx)(o.td,{children:"session"}),(0,t.jsx)(o.td,{children:"Powers the Recent Viewed Products widget."})]}),(0,t.jsxs)(o.tr,{children:[(0,t.jsx)(o.td,{children:"store_notice[notice id]"}),(0,t.jsx)(o.td,{children:"session"}),(0,t.jsx)(o.td,{children:"Allows customers to dismiss the Store Notice."})]})]})]}),"\n",(0,t.jsx)(o.p,{children:"We're unable to cover all options, but we have added some tips for the popular caching plugins. For more specific support, please reach out to the support team responsible for your caching integration."}),"\n",(0,t.jsx)(o.h3,{id:"w3-total-cache-minify-settings",children:"W3 total cache minify settings"}),"\n",(0,t.jsx)(o.p,{children:"Ensure you add 'mfunc' to the 'Ignored comment stems' option in the Minify settings."}),"\n",(0,t.jsx)(o.h3,{id:"wp-rocket",children:"WP-Rocket"}),"\n",(0,t.jsx)(o.p,{children:"WooCommerce is fully compatible with WP-Rocket. Please ensure that the following pages (Cart, Checkout, My Account) are not to be cached in the plugin's settings."}),"\n",(0,t.jsx)(o.p,{children:"We recommend avoiding JavaScript file minification."}),"\n",(0,t.jsx)(o.h3,{id:"wp-super-cache",children:"WP Super Cache"}),"\n",(0,t.jsx)(o.p,{children:"WooCommerce is natively compatible with WP Super Cache. WooCommerce sends information to WP Super Cache so that it doesn't cache the Cart, Checkout, or My Account pages by default."}),"\n",(0,t.jsx)(o.h3,{id:"varnish",children:"Varnish"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-varnish",children:'if (req.url ~ "^/(cart|my-account|checkout|addons)") {\n  return (pass);\n}\nif ( req.url ~ "\\\\?add-to-cart=" ) {\n  return (pass);\n}\n'})}),"\n",(0,t.jsx)(o.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,t.jsx)(o.h3,{id:"why-is-my-varnish-configuration-not-working-in-woocommerce",children:"Why is my Varnish configuration not working in WooCommerce?"}),"\n",(0,t.jsxs)(o.p,{children:["Check out the following WordPress.org Support forum post on",(0,t.jsx)(o.a,{href:"https://wordpress.org/support/topic/varnish-configuration-not-working-in-woocommerce",children:" how cookies may be affecting your varnish coding"}),"."]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-text",children:'Add this to vcl_recv above "if (req.http.cookie) {":\n\n# Unset Cookies except for WordPress admin and WooCommerce pages \nif (!(req.url ~ "(wp-login|wp-admin|cart|my-account/*|wc-api*|checkout|addons|logout|lost-password|product/*)")) { \nunset req.http.cookie; \n} \n# Pass through the WooCommerce dynamic pages \nif (req.url ~ "^/(cart|my-account/*|checkout|wc-api/*|addons|logout|lost-password|product/*)") { \nreturn (pass); \n} \n# Pass through the WooCommerce add to cart \nif (req.url ~ "\\?add-to-cart=" ) { \nreturn (pass); \n} \n# Pass through the WooCommerce API\nif (req.url ~ "\\?wc-api=" ) { \nreturn (pass); \n} \n# Block access to php admin pages via website \nif (req.url ~ "^/phpmyadmin/.*$" || req.url ~ "^/phppgadmin/.*$" || req.url ~ "^/server-status.*$") { \nerror 403 "For security reasons, this URL is only accessible using localhost (127.0.0.1) as the hostname"; \n} \n\nAdd this to vcl_fetch:\n\n# Unset Cookies except for WordPress admin and WooCommerce pages \nif ( (!(req.url ~ "(wp-(login|admin)|login|cart|my-account/*|wc-api*|checkout|addons|logout|lost-password|product/*)")) || (req.request == "GET") ) { \nunset beresp.http.set-cookie; \n} \n'})}),"\n",(0,t.jsx)(o.h3,{id:"why-is-my-password-reset-stuck-in-a-loop",children:"Why is my Password Reset stuck in a loop?"}),"\n",(0,t.jsx)(o.p,{children:"This is due to the My Account page being cached, Some hosts with server-side caching don't prevent my-account.php from being cached."}),"\n",(0,t.jsx)(o.p,{children:"If you're unable to reset your password and keep being returned to the login screen, please speak to your host to make sure this page is being excluded from their caching."})]})}function l(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,o,n)=>{n.d(o,{R:()=>r,x:()=>i});var c=n(6540);const t={},s=c.createContext(t);function r(e){const o=c.useContext(s);return c.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function i(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),c.createElement(s.Provider,{value:o},e.children)}}}]);